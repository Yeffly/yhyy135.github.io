<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="Acuario" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"always","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"default"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="命名空间（namespace）基本概念 PHP 命名空间与操作系统的物理文件系统不同，这是一个虚拟概念，没必要和文件系统中的目录结构完全对应。但是大多数 PHP 组件为了兼容 PSR-4 自动加载器标准，会把子命名空间放到文件系统的子目录中。 从技术层面来看，命名空间只是 PHP 语言中的一种记号，PHP 解释器会将其作为前缀添加到类、接口、函数和常量的名称前面。 不同代码可能使用相同的类名、接口">
<meta name="keywords" content="学习笔记,PHP,Modern PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="《Modern PHP》学习笔记">
<meta property="og:url" content="https://acuario.xyz/modern-php-summary/index.html">
<meta property="og:site_name" content="Acuario">
<meta property="og:description" content="命名空间（namespace）基本概念 PHP 命名空间与操作系统的物理文件系统不同，这是一个虚拟概念，没必要和文件系统中的目录结构完全对应。但是大多数 PHP 组件为了兼容 PSR-4 自动加载器标准，会把子命名空间放到文件系统的子目录中。 从技术层面来看，命名空间只是 PHP 语言中的一种记号，PHP 解释器会将其作为前缀添加到类、接口、函数和常量的名称前面。 不同代码可能使用相同的类名、接口">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-24T08:52:09.940Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《Modern PHP》学习笔记">
<meta name="twitter:description" content="命名空间（namespace）基本概念 PHP 命名空间与操作系统的物理文件系统不同，这是一个虚拟概念，没必要和文件系统中的目录结构完全对应。但是大多数 PHP 组件为了兼容 PSR-4 自动加载器标准，会把子命名空间放到文件系统的子目录中。 从技术层面来看，命名空间只是 PHP 语言中的一种记号，PHP 解释器会将其作为前缀添加到类、接口、函数和常量的名称前面。 不同代码可能使用相同的类名、接口">
  <link rel="canonical" href="https://acuario.xyz/modern-php-summary/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>
<script src="https://use.typekit.net/dzs0zzd.js"></script>
<script>try{Typekit.load({ async: true });}catch(e){}</script>
  <title>《Modern PHP》学习笔记 | Acuario</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83619854-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-83619854-1');
    }
  </script>








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Acuario</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://acuario.xyz/modern-php-summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Acuario">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Acuario">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">《Modern PHP》学习笔记

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-08-24 16:33:23 / 修改时间：16:52:09" itemprop="dateCreated datePublished" datetime="2019-08-24T16:33:23+08:00">2019-08-24</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习笔记/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习笔记/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/modern-php-summary/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="modern-php-summary/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="命名空间（namespace）"><a href="#命名空间（namespace）" class="headerlink" title="命名空间（namespace）"></a>命名空间（namespace）</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>PHP 命名空间与操作系统的物理文件系统不同，这是一个虚拟概念，没必要和文件系统中的目录结构完全对应。但是大多数 PHP 组件为了兼容 PSR-4 自动加载器标准，会把子命名空间放到文件系统的子目录中。</li>
<li>从技术层面来看，命名空间只是 PHP 语言中的一种记号，PHP 解释器会将其作为前缀添加到类、接口、函数和常量的名称前面。</li>
<li>不同代码可能使用相同的类名、接口名、函数名或常量名，如果不使用命名空间，名称会起冲突，导致 PHP 执行出错。而使用命名空间，把代码放在唯一的厂商命名空间中，这样不同命名空间下的代码就可以使用相同的名称命名类、接口、函数和常量。</li>
<li>在同一个命名空间或子命名空间中的所有类没必要在同一个 PHP 文件中声明。你可以在 PHP 文件的顶部指定一个命名空间或子命名空间，此时，这个文件中的代码就是该命名空间或子命名空间的一部分。因此，我们可以在不同的文件中编写属于同一个命名空间的多个类。</li>
</ul>
<a id="more"></a>
<h2 id="导入和别名"><a href="#导入和别名" class="headerlink" title="导入和别名"></a>导入和别名</h2><ul>
<li><strong>导入</strong>是指在每个 PHP 文件中告诉 PHP 想使用哪个命名空间、类、接口、函数和常量。导入后就不用输入全名了。</li>
<li><strong>创建别名</strong>是指告诉 PHP 我要使用简单的名称引用导入的类、接口、函数或常量。</li>
<li>使用 <code>use</code> 关键字导入代码时无需在开头加上符号，因为 PHP 假定导入的是<strong>完全限定</strong>的命名空间。</li>
<li><code>use</code> 关键字必须出现在<strong>全局作用域</strong>中（即不能在类或函数中），因为这个关键字在编译时使用。不过，use 关键字可以在命名空间声明语句之后使用，导入其他命名空间中的代码。</li>
<li>导入函数和常量:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">use func Namespace\functionName;</span><br><span class="line">use constant Namespace\CONST_NAME;</span><br><span class="line">functionName();</span><br><span class="line">echo CONST_NAME;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>一个文件定义一个类</strong>，一个文件只使用一个命名空间。</li>
<li>有些代码可能没有命名空间，这些代码在全局命名空间中。如果需要在命名空间中引用其他命名空间中的类、接口、函数或常量，必须使用完全限定的 PHP 类名（命名空间类名）。在命名空间中引用全局命名空间中的代码时，要在类、接口、函数或常量的名称前加上 <code>\</code> 符号。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace My\App;</span><br><span class="line"></span><br><span class="line">Class Foo</span><br><span class="line">&#123;</span><br><span class="line">    public function dosomething() &#123;</span><br><span class="line">        $exception1 = new Exception();      // \My\App\Exception 类中搜索</span><br><span class="line">        $exception2 = new \Exception();     // PHP 原生的 Exception 类</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="接口（interface）"><a href="#接口（interface）" class="headerlink" title="接口（interface）"></a>接口（interface）</h1><ul>
<li>接口是两个 PHP 对象之间的契约，其目的不是让一个对象依赖另一个对象的身份，而是依赖另一个对象的能力。</li>
<li>接口将项目代码和依赖解耦，并允许项目代码依赖任何实现了预期接口的第三方代码而<strong>不用关心第三方代码是如何实现接口的，只关心第三方代码是否实现了指定的接口</strong>。</li>
</ul>
<p>例程（<a href="https://github.com/codeguy/modern-php/tree/master/02-features/interfaces" target="_blank" rel="noopener">完整版</a>）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$documentStore = new DocumentStore();</span><br><span class="line"></span><br><span class="line">// Add HTML document</span><br><span class="line">$htmlDoc = new HtmlDocument(&apos;http://php.net&apos;);</span><br><span class="line">$documentStore-&gt;addDocument($htmlDoc);</span><br><span class="line"></span><br><span class="line">// Add terminal command document</span><br><span class="line">$cmdDoc = new CommandOutputDocument(&apos;cat /etc/hosts&apos;);</span><br><span class="line">$documentStore-&gt;addDocument($cmdDoc);</span><br><span class="line"></span><br><span class="line">print_r($documentStore-&gt;getDocuments());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DocumentStore</span><br><span class="line">&#123;</span><br><span class="line">    protected $data = [];</span><br><span class="line">    public function addDocument(Documentable $document)</span><br><span class="line">    &#123;</span><br><span class="line">        $key = $document-&gt;getId();</span><br><span class="line">        $value = $document-&gt;getContent();</span><br><span class="line">        $this-&gt;data[$key] = $value;</span><br><span class="line">    &#125;</span><br><span class="line">    public function getDocuments()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface Documentable</span><br><span class="line">&#123;</span><br><span class="line">    public function getId();</span><br><span class="line">    public function getContent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class CommandOutputDocument implements Documentable</span><br><span class="line">&#123;</span><br><span class="line">    protected $command;</span><br><span class="line"></span><br><span class="line">    public function __construct($command)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;command = $command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getId()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getContent()</span><br><span class="line">    &#123;</span><br><span class="line">        return shell_exec($this-&gt;command);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HtmlDocument implements Documentable</span><br><span class="line">&#123;</span><br><span class="line">    protected $url;</span><br><span class="line"></span><br><span class="line">    public function __construct($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;url = $url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getId()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getContent()</span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $this-&gt;url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 3);</span><br><span class="line">        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);</span><br><span class="line">        curl_setopt($ch, CURLOPT_MAXREDIRS, 3);</span><br><span class="line">        $html = curl_exec($ch);</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        return $html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="性状（trait）"><a href="#性状（trait）" class="headerlink" title="性状（trait）"></a>性状（trait）</h1><ul>
<li>性状既不是类也不是接口，而是类的部分实现（即常量，属性和方法），可以混入一个或多个现有的 PHP 类中。</li>
<li>性状的作用：<ol>
<li>表明类可以做什么（类似接口）；</li>
<li>提供模块化实现（类似类）。</li>
</ol>
</li>
<li>性状能把模块化的实现方式注入多个无关的类中。而且性状还能促进代码重用。</li>
<li>使用性状的场景：<ol>
<li>创建一个基类，然后共同集成这个基类，将共用方法写在基类中。但无关的两个类并不应集成相同的父类。</li>
<li>创建接口，然后在两个类中分别实现该接口并使用。但如果实现方法相同，则违背了 DRY（Don’t Repeat Yourself）原则。</li>
</ol>
</li>
<li>与定义类和接口一样，一个文件只定义一个性状。</li>
<li>命名空间、类、接口函数和常量<strong>在类的定义体外</strong>导入，而性状<strong>在类的定义体内</strong>导入。</li>
<li>PHP 解释器在编译时会把性状复制粘贴到类的定义体中，但是<strong>不会处理这个操作引入的不兼容问題</strong>。如果性状假定类中有特定的属性或方法（在性状中没有定义），要确保相应的类中有对应的属性和方法。</li>
</ul>
<p>例程：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$adapter = new \Ivory\HttpAdapter\CurlHttpAdapter();</span><br><span class="line">$geocoder = new \Geocoder\Provider\GoogleMaps($adapter);</span><br><span class="line"></span><br><span class="line">$store = new RetailStore();</span><br><span class="line">$store-&gt;setAddress(&apos;420 9th Avenue, New York, NY 10001 USA&apos;);</span><br><span class="line">$store-&gt;setGeocoder($geocoder);</span><br><span class="line"></span><br><span class="line">$latitude = $store-&gt;getLatitude();</span><br><span class="line">$longitude = $store-&gt;getLongitude();</span><br><span class="line"></span><br><span class="line">echo $latitude, &apos;:&apos;, $longitude;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class RetailStore</span><br><span class="line">&#123;</span><br><span class="line">    use TraitExample;</span><br><span class="line"></span><br><span class="line">    //......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">trait Geocodable</span><br><span class="line">&#123;</span><br><span class="line">    /** @var string */</span><br><span class="line">    protected $address;</span><br><span class="line"></span><br><span class="line">    /** @var \Geocoder\Geocoder */</span><br><span class="line">    protected $geocoder;</span><br><span class="line"></span><br><span class="line">    /** @var \Geocoder\Model\AddressCollection */</span><br><span class="line">    protected $geocoderResult;</span><br><span class="line"></span><br><span class="line">    public function setGeocoder(\Geocoder\Geocoder $geocoder)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;geocoder = $geocoder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function setAddress($address)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;address = $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getLatitude()</span><br><span class="line">    &#123;</span><br><span class="line">        if (!isset($this-&gt;geocoderResult)) &#123;</span><br><span class="line">            $this-&gt;geocodeAddress();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $this-&gt;geocoderResult-&gt;first()-&gt;getLatitude();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getLongitude()</span><br><span class="line">    &#123;</span><br><span class="line">        if (!isset($this-&gt;geocoderResult)) &#123;</span><br><span class="line">            $this-&gt;geocodeAddress();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $this-&gt;geocoderResult-&gt;first()-&gt;getLongitude();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected function geocodeAddress()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;geocoderResult = $this-&gt;geocoder-&gt;geocode($this-&gt;address);</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="生成器（generator）"><a href="#生成器（generator）" class="headerlink" title="生成器（generator）"></a>生成器（generator）</h1><ul>
<li>生成器是简单的<strong>迭代器</strong>。</li>
<li>PHP 生成器不要求类实现 <code>Iterator</code> 接口，并会根据需求即时计算并产出要迭代的值，不占用宝贵的内存资源。</li>
<li>生成器是<strong>一次性的</strong>，无法多次迭代同个生成器，但可以重建或克隆生成器</li>
<li>每次产出一个值之后，生成器的内部状态都会停顿；向生成器请求下一个值时，内部状态又会恢复。生成器的内部状态会一直在停顿和恢复之间切换，直到抵达函数定义体的末尾或遇到空的 return；语句为止。</li>
<li>生成器是<strong>只能向前进的迭代器</strong>，不能使用生成器在数据集中执行后退、快进或査找操作，只能让生成器计算并产生下一个值。迭代大型数据集或数列时最适合使用生成器，因为这样占用的系统内存量极少。</li>
<li>更多技巧与实践：<a href="https://www.twitter.com/ircmaxell" target="_blank" rel="noopener">@ircmaxell</a> - <a href="https://blog.ircmaxell.com/2012/07/what-generators-can-do-for-you.html" target="_blank" rel="noopener">What Generators Can Do For You</a></li>
</ul>
<p>例程一：生成一个范围内的数值数组且善用内存</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function makeRange($length) &#123;</span><br><span class="line">    for ($i = 0; $i &lt; $length; $i++) &#123;</span><br><span class="line">        yield $i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach (makeRange(1000000) as $i) &#123;</span><br><span class="line">    echo $i . PHP_EOL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例程二：读取一个超过 PHP 可用内存上限的 CSV 文件。只为 CSV 文件中的一行分配内存，而不会把整个 CSV 文件都读取到内存中。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function getRows($file) &#123;</span><br><span class="line">    $handle = fopen($file, &apos;rb&apos;);</span><br><span class="line">    if (!$handle) &#123;</span><br><span class="line">        throw new Exception();</span><br><span class="line">    &#125;</span><br><span class="line">    while (!feof($handle)) &#123;</span><br><span class="line">        yield fgetcsv($handle);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach (getRows(&apos;data.csv&apos;) as $row) &#123;</span><br><span class="line">    print_r($row);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="闭包（closure）"><a href="#闭包（closure）" class="headerlink" title="闭包（closure）"></a>闭包（closure）</h1><ul>
<li><strong>闭包</strong>是指在创建时封装周围状态的函数。即便闭包所在的环境不存在了，闭包中封装的状态依然存在。</li>
<li><strong>匿名函数</strong>就是没有名称的函数，可以调用，还可以传入参数。</li>
<li>匿名函数<strong>可以赋值给变量</strong>，还能像对象那样传递。</li>
<li>匿名函数适合作为函数或方法的回调。</li>
<li>在 PHP 中，匿名函数 = 闭包。</li>
<li>闭包和匿名函数是<strong>伪装成函数的对象</strong>。</li>
<li>PHP 闭包不会自动封装应用的状态，必须手动调用闭包对象的 <code>bindto()</code> 方法或者使用 <code>use</code> 关键字，把状态附加到 PHP 闭包上，这样即便返回的闭包对象跳出了其函数的作用域，它也会记住参数的值，即将应用状态封装起来。</li>
<li>与任何其他 PHP 对象类似，每个闭包实例都可以使用 $this 关键字获取闭包的内部状态。<code>bindto()</code> 方法可以把 Closure 对象的内部状态绑定到其他对象上。</li>
<li>闭包可以访问绑定闭包的对象中受保护和私有的成员变量。</li>
</ul>
<p>例程一：普通闭包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$numbersPlusOne = array_map(function ($number) &#123;</span><br><span class="line">    return $number + 1;</span><br><span class="line">&#125;, [1,2,3]);</span><br><span class="line"></span><br><span class="line">print_r($numbersPlusOne);</span><br><span class="line"></span><br><span class="line">// Outputs --&gt; [2,3,4]</span><br></pre></td></tr></table></figure>
<p>例程二：封装应用状态的闭包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function enclosePerson($name) &#123;</span><br><span class="line">    return function ($doCommand) use ($name) &#123;</span><br><span class="line">        return sprintf(&apos;%s, %s&apos;, $name, $doCommand);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Enclose &quot;Clay&quot; string in closure</span><br><span class="line">$clay = enclosePerson(&apos;Clay&apos;);</span><br><span class="line"></span><br><span class="line">// Invoke closure with command</span><br><span class="line">echo $clay(&apos;get me sweet tea!&apos;);</span><br><span class="line">// Outputs --&gt; &quot;Clay, get me sweet tea!&quot;</span><br></pre></td></tr></table></figure>
<h1 id="Zend-OPcache"><a href="#Zend-OPcache" class="headerlink" title="Zend OPcache"></a>Zend OPcache</h1><ul>
<li>PHP 是解释型语言，PHP 解释器执行 PHP 脚本时会解析 PHP 脚本代码，把 PHP 代码编译成一系列 <a href="http://bit.ly/zend-opcode" target="_blank" rel="noopener">Zend 操作码</a>，然后执行字节码。Zend OPcache 可以让 PHP 解释器从内存中读取预先编译好的字节码，然后立即执行。这样能节省很多时间，极大地提升应用的性能。</li>
<li><p>启用步骤：</p>
<ol>
<li>编译：<code>$ ./configure --enable-opcache</code></li>
<li>启用扩展：<code>zend_extension=/path/to/opcache.so</code></li>
<li><p>配置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opcache.validate_timestamps = 1 //检测 PHP 脚本变动。建议生产环境设为 0</span><br><span class="line">opcache.revalidate_freq = 0 //检査 PHP 脚本内容变化的周期，单位秒。</span><br><span class="line">opcache.memory_consumption = 64 // 为操作码缓存分配的内存量（单位是 MB）。分配的内存量应该够保存应用中所有 PHP 脚本编译得到的操作码。</span><br><span class="line">opcache.interned_strings_buffer = 16 // 用来存储驻留字符串（interned string）的内存量（单位是 MB）。默认值为 4MB。</span><br><span class="line">opcache.max_accelerated_files = 4000 // 操作码缓存中最多能存储多少个 PHP 脚本。</span><br><span class="line">opcache.fast_shutdown = 1 // 设置操作码使用更快的停机步骤</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h1 id="内置的-HTTP-服务器"><a href="#内置的-HTTP-服务器" class="headerlink" title="内置的 HTTP 服务器"></a>内置的 HTTP 服务器</h1><ul>
<li>从 PHP 5.4.0 起，PHP 内置了 Web 服务器。</li>
<li>启动本地运行：<code>$ php -S localhost:4000</code></li>
<li>启动局域网访问：<code>$ php -S 0.0.0.0:4000</code></li>
<li>指定配置文件启动：<code>$ php -S localhost:8000 -c app/config/php.ini</code></li>
<li>指定路由器脚本启动：<code>$ php -S localhost:8000 router.php</code></li>
<li>内置的 HTTP 服务器仅用于本地开发调试，不应使用于生产环境。</li>
</ul>
<h1 id="标准"><a href="#标准" class="headerlink" title="标准"></a>标准</h1><ul>
<li>PHP Framework Interop Group（简称 PHP-FIG，<a href="http://www.php-fig.org" target="_blank" rel="noopener">http://www.php-fig.org</a> ）。PHP-FIG 由一些 PHP 框架代表组成，PHP-FIG 制定了推荐规范，PHP 框架可以自愿实现这些规范，改进与其他框架的通信和共享功能。</li>
<li>PHP-FIG 的使命是实现框架的互操作性：通过接口、自动加载机制和标准的风格，让框架相互合作。</li>
<li>接口：框架通过 PHP 接口假定第三方依赖提供了什么方法，而不关心依赖是如何实现接口的。<ul>
<li>自动加载：PHP 解释器在运行时按需自动找到并加载 PHP 类的过程。只需使用一个自动加载器就能混合搭配多个 PHP 组件。</li>
<li>风格：指定如何使用空格、大小写和括号的位置（等等）之类的代码格式规范。</li>
</ul>
</li>
</ul>
<h2 id="PSR-1：基本的代码风格"><a href="#PSR-1：基本的代码风格" class="headerlink" title="PSR-1：基本的代码风格"></a>PSR-1：基本的代码风格</h2><ul>
<li>PHP 标签：使用 <code>&lt;?php ?&gt;</code> 或 <code>&lt;?= ?&gt;</code></li>
<li>编码：使用 <code>UTF-8</code> 编码</li>
<li>目的：一个 PHP 文件只处理一件事</li>
<li>自动加载：PHP 命名空间和类必须遵守 PSR-4 自动加载器标准</li>
<li>类的名称：PHP 类的名称必须一直使用<strong>大驼峰式</strong>（CamelCase）</li>
<li>常量名称：PHP 常量的名称必须全部使用<strong>大写</strong>字母</li>
<li>方法名称：PHP 方法的名称必须一直使用<strong>小驼峰式</strong>（camelCase）</li>
</ul>
<h2 id="PSR-2：严格的代码风格"><a href="#PSR-2：严格的代码风格" class="headerlink" title="PSR-2：严格的代码风格"></a>PSR-2：严格的代码风格</h2><ul>
<li>贯彻 PSR-1</li>
<li>缩进：使用四个空格缩进。</li>
<li>文件和代码行：使用 UNIX 换行符（LF），文末<strong>留一个空行</strong>，<strong>不使用</strong> PHP 关闭标签 <code>?&gt;</code>。每行代码<strong>不超过</strong> 80 个字符，<strong>至少不能超过</strong> 120 个字符。每行末尾<strong>不能有空格</strong>。</li>
<li>关键字：使用<strong>小写字母</strong>。</li>
<li>命名空间：命名空间声明语句和 <code>use</code> 声明语句后<strong>留一个空行</strong>。</li>
<li>类：类定义体的起始括号在类名之后<strong>新起一行写</strong>。扩展类或实现接口的 <code>extends</code> 和 <code>implements</code> 关键字必须和类名<strong>写在同一行</strong>。</li>
<li>方法：方法定义体的起始括号要在方法名之后<strong>新起一行写</strong>。方法定义体的结束括号要在方法定义体之后新起一行写。起始圆括号之后<strong>没有空格</strong>，结束圆括号之前<strong>没有空格</strong>。方法的参数后面有<strong>一个逗号和空格</strong>。</li>
<li>可见性：类中的每个属性和方法都要声明可见性。<code>abstract</code> 或 <code>final</code> 限定符放在可见性关键字<strong>之前</strong>，<code>static</code> 限定符放在可见性关键字<strong>之后</strong>。</li>
<li>控制结构：所有控制结构关键字（<code>if</code>、<code>elseif</code>、<code>else</code>、<code>switch</code>、<code>case</code>、<code>while</code>、<code>do while</code>、<code>for</code>、<code>foreach</code>、<code>try</code>、<code>catch</code>）后面都要有<strong>一个空格</strong>。控制结构关键字后面的起始圆括号后面<strong>没有空格</strong>，结束圆括号之前<strong>没有空格</strong>，起始括号和控制结构关键字<strong>写在同一行</strong>，结束括号<strong>单独写在一行</strong>。</li>
</ul>
<h2 id="PSR-3：日志记录器接口"><a href="#PSR-3：日志记录器接口" class="headerlink" title="PSR-3：日志记录器接口"></a>PSR-3：日志记录器接口</h2><ul>
<li>PSR-3 是一个接口，规定 PHP 日志记录器组件可以实现的方法。</li>
<li>PSR-3 要求日志记录器必须实现 9 个方法：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace Psr\Log;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * See https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md</span><br><span class="line"> * for the full interface specification.</span><br><span class="line"> */</span><br><span class="line">interface LoggerInterface</span><br><span class="line">&#123;</span><br><span class="line">    public function emergency($message, array $context = array());</span><br><span class="line">    public function alert($message, array $context = array());</span><br><span class="line">    public function critical($message, array $context = array());</span><br><span class="line">    public function error($message, array $context = array());</span><br><span class="line">    public function warning($message, array $context = array());</span><br><span class="line">    public function notice($message, array $context = array());</span><br><span class="line">    public function info($message, array $context = array());</span><br><span class="line">    public function debug($message, array $context = array());</span><br><span class="line">    public function log($level, $message, array $context = array());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>推荐使用符合 PSR-3 规范的日志记录器 <a href="https://packagist.org/packages/monolog/monolog" target="_blank" rel="noopener">monolog/monolog</a></li>
</ul>
<h2 id="PSR-4：自动加载器"><a href="#PSR-4：自动加载器" class="headerlink" title="PSR-4：自动加载器"></a>PSR-4：自动加载器</h2><ul>
<li>PSR-4 是一个标准的自动加载器策略，规定运行时按需査找 PHP 类、接口或性状，并将其载入 PHP 解释器。</li>
<li>自动加载器的引入解决了使用 <code>require()</code> 函数和 <code>include()</code> 函数手动引入文件的繁琐。</li>
<li>PSR-4 推荐规范不要求改变代码的实现方式，只建议如何使用文件系统目录结构和 PHP 命名空间组织代码。</li>
<li>PSR-4 自动加载器策略依赖 PHP 命名空间和文件系统目录结构査找并加载 PHP 类、接口和性状。</li>
<li>PSR-4 会把命名空间的前缀和文件系统中的目录对应起来。命名空间的前缀可以是顶层命名空间，也可以是顶层命名空间加上任意一个子命名空间。</li>
<li>推荐使用依赖管理器 <a href="https://getcomposer.org/" target="_blank" rel="noopener">Composer</a> 来自动生成符合 PSR-4 规范的自动加载器。</li>
</ul>
<h1 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h1><ul>
<li>PHP 组件是一系列相关的类、接口和性状，用于解决某个具体问题。组件中的类、接口和性状通常放在同一个命名空间中。</li>
<li>好的 PHP 组件具有以下特征：<ul>
<li>作用单一：专注于解决一个问题，而且使用简单的接口封装功能。</li>
<li>小型：只包含解决某个问题所需的最少代码。</li>
<li>合作：PHP 组件之间能良好合作。把代码放在自己的命名空间中，防止与其他组件有名称冲突。</li>
<li>测试良好：组件本身会提供测试，而且有充足的测试覆盖度。</li>
<li>文档完善：有个 README 文件，说明组件的作用，如何安装，以及如何使用。抑或有网站介绍详细信息。</li>
</ul>
</li>
<li>如果是能通过一些 PHP 组件准确解决问题的小型项目，那就使用组件。如果是有多个团队成员开发的大型项目，而且能从框架提供的约定、准则和结构中受益，那就使用框架。</li>
<li>查找组件目录：<a href="https://packagist.org/" target="_blank" rel="noopener">Packagist</a></li>
<li>安装组件的工具：<a href="https://getcomposer.org/" target="_blank" rel="noopener">Composer</a></li>
<li>自动加载是指在不使用 <code>require()</code>、<code>require_once()</code>、<code>include()</code> 或 <code>include_once()</code> 函数的情况下按需自动加载 PHP 类。</li>
<li>在较旧的 PHP 版本中可以使用 <code>autoload()</code> 函数自己编写自动加载器；实例化尚未加载的类时，PHP 解释器会自动调用这个函数。后来，PHP 在 SPL 库中引入了更灵活的 <code>sql_autoload_register()</code> 函数。如何自动加载 PHP 类完全由开发者决定。依赖管理器 Composer 为项目中的所有 PHP 组件自动生成符合 PSR 标准的自动加载器。Composers 有效抽象了依赖管理和自动加载。</li>
<li>Composer 和 Packagisti 都使用 <code>vendor/package</code> 这种命名约定，避免不同厂商的 PHP 组件有名称冲突。</li>
<li>PHP 组件版本号（如，1.13.2)语义：<ol>
<li>第一个数字是主版本号，用于破坏了向后兼容性的版本更新。</li>
<li>第二个数字是次版本号，用于没破坏向后兼容性的小幅功能更新。</li>
<li>第三个数字是修订版本号，用于对向后兼容的缺陷的修正。</li>
</ol>
</li>
<li><code>composer install</code> 命令不会安装比 <code>composer.lock</code> 文件中列出的版本号新的版本。</li>
<li><code>composer update</code> 命令会把组件更新到最新稳定版，还会更新 <code>composer.lock</code> 文件，写入 PHP 组件的新版本号。</li>
<li>Composer 创建的自动加载器就是 <code>vendor/autoload.php</code> 文件。Composer 下载各个 PHP 组件时会检査每个组件的 <code>composer.json</code> 文件，确定如何加载该组件。</li>
<li>Composer 仓库的凭据 <code>auth.php</code> 文件放在和 <code>composer.json</code> 文件同级目录，且不应加入版本控制：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;http-basic&quot;: &#123;</span><br><span class="line">        &quot;example.org&quot; :&#123;</span><br><span class="line">            &quot;username&quot;: &quot;your-name&quot;,</span><br><span class="line">            &quot;password&quot;: &quot;your-password&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>composer.json</code> 文件结构：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;: &quot;组件名称&quot;,</span><br><span class="line">    &quot;description&quot;: &quot;描述&quot;,</span><br><span class="line">    &quot;keywords&quot;: [关键词],</span><br><span class="line">    &quot;homepage&quot;: &quot;组件主页&quot;,</span><br><span class="line">    &quot;license&quot;: &quot;软件许可协议&quot;,</span><br><span class="line">    &quot;authors&quot;: [作者信息],</span><br><span class="line">    &quot;support&quot;: &#123;获取技术支持的方式&#125;,</span><br><span class="line">    &quot;require&quot;: &#123;依赖的组件&#125;,</span><br><span class="line">    &quot;require-dev&quot;: &#123;开发该组件时依赖的组件&#125;,</span><br><span class="line">    &quot;suggest&quot;: &#123;建议安装的组件&#125;,</span><br><span class="line">    &quot;autoload&quot;: &#123;自动加载方式&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Packagist 从组件的 <code>composer.json</code> 文件中读取了组件的名称、描述、关键字依赖和建议。还会发现显示了仓库的分支和标签。同时 Packagist 会把仓库的标签和语言版本号对应起来。</p>
</li>
</ul>
<h1 id="良好实践"><a href="#良好实践" class="headerlink" title="良好实践"></a>良好实践</h1><h2 id="过滤、验证和转义"><a href="#过滤、验证和转义" class="headerlink" title="过滤、验证和转义"></a>过滤、验证和转义</h2><ul>
<li>不要相信任何来自不受自己直接控制的数据源中的数据。</li>
<li>过滤输入：转义或删除不安全的字符。在数据到达应用的存储层之前，一定要过滤输入数据。建议不使用正则表达式函数过滤 HTML，正则表达式很复杂，可能导致 HTML 无效，且出错的几率高。</li>
<li>验证数据：确认输入的数据符合预期，在应用的存储层保存符合特定格式的正确数据。避免数据库出现潜在的错误。</li>
<li>转义输出：避免渲染恶意代码，还能防止应用的用户无意中执行恶意代码。</li>
</ul>
<h2 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h2><ul>
<li>绝对不能知道用户的密码</li>
<li>绝对不要约束用户的密码</li>
<li>绝对不能通过电子邮件发送用户的密码</li>
<li>使用 <code>bcrypt</code> 计算用户密码的哈希值。<code>bcrypt</code> 算法会自动加盐，防止潜在的彩虹表攻击。<code>bcrypt</code> 算法永不过时，如果计算机的运算速度变快了，我们只需提高工作因子的值。<code>bcrypt</code> 算法得到了同行的大量审查，目前暂无漏洞。</li>
<li>加密和哈希不是一回事。加密是双向算法，加密的数据以后可以解密。而哈希是单向算法，哈希后的数据不能再还原成原始值，而且相同的数据得到的哈希值始终相同。</li>
</ul>
<h2 id="日期、时间和时区"><a href="#日期、时间和时区" class="headerlink" title="日期、时间和时区"></a>日期、时间和时区</h2><ul>
<li>推荐使用 <a href="https://github.com/briannesbitt/Carbon" target="_blank" rel="noopener"><code>nesbit/carbon</code></a> 组件处理日期和时间值的有用方法。</li>
</ul>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><ul>
<li>PDO 扩展：PDO（PHP Data Objects，PHP 数据对象）是一系列 PHP 类，抽象了不同数据库的具体实现，只通过一个用户界面就能与多种不同的 SQL 数据库通信。不管使用哪种数据库系统，使用一个接口就能编写和执行数据库査询</li>
<li>使用 PDO 时，建议编写符合 <code>ANSI/ISO</code> 标准的 SQL 语句，这样如果更换数据库系统 SQL 语句不会失效。</li>
<li>数据库凭据应保存在一个位于文档根目录之外的配置文件中，然后在需要使用凭据的 PHP 文件中导入。另外，凭据也不能纳入版本控制，避免因仓库公开而泄漏凭据。</li>
<li><strong>事务</strong>：指把一系列数据库语句当成单个逻辑单元（具有原子性）执行。事务中的一系列 SQL 査询要么都成功执行，要么根本不执行。</li>
<li>事务的一个副作用一一提升性能——事务把多个査询排成队列，一次全部执行。</li>
<li>PHP 中处理字符串的函数默认假设所有字符串都只使用 8 位字符，如果使用这些 PHP 原生的字符串函数处理包含多字节字符的 Unicode 字符串，可能会出错。为避免处理多字节字符串时出错，可以安装 <a href="http://php.net/manual/book.mbstring.php" target="_blank" rel="noopener"><code>mbstring</code> 扩展</a>。该扩展提供了能替代大多数 PHP 原生的且能处理多字节字符串的函数。</li>
<li>PHP 编码配置(<code>pip.ini</code>)：<code>default charset = &quot;utf-8&quot;</code></li>
</ul>
<h2 id="错误和异常"><a href="#错误和异常" class="headerlink" title="错误和异常"></a>错误和异常</h2><ul>
<li>错误会导致程序脚本停止执行，有些错误无法恢复，其他错误可使用全局错误处理程序处理。</li>
<li>预测測、捕获并处理异常是我们自己的责任。未捕获的异常会导致 PHP 应用终止运行，显示致命错误信息。而更糟的是，可能会暴露敏感的调试详细信息，让应用的用户看到。因此，一定要使用 <code>try/catch</code> 块捕获异常，然后使用优雅的方式处理。</li>
<li>捕获某种异常时只会运行其中一个 catch 块。如果 PHP 没找到适用的 catch 块，异常会向上冒泡，直到 PHP 脚本由于致命错误而终止运行。</li>
<li>PHP 异常可以在 PHP 应用的任何层级抛出和捕获。</li>
<li>PHP 异常和错误设置原则：<ul>
<li>一定要让 PHP 报告错误。</li>
<li>在开发环境中要显示错误。</li>
<li>在生产环境中不能显示错误。</li>
<li>在开发环境和生产环境中都要记录错误。</li>
</ul>
</li>
<li>推荐配置：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">; 开发环境</span><br><span class="line">; 显示错误</span><br><span class="line">display_startup_errors = On</span><br><span class="line">display_errors = On</span><br><span class="line">; 报告所有错误</span><br><span class="line">error_reporting = -1</span><br><span class="line">; 记录错误</span><br><span class="line">log_errors = On</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;生产环境</span><br><span class="line">; 不显示错误</span><br><span class="line">display_startup_errors = Off</span><br><span class="line">display_errors = Off</span><br><span class="line">; 除了注意事项之外，报告所有其他错误</span><br><span class="line">error_reporting = E_ALL &amp; ~E_NOTICE</span><br><span class="line">; 记录错误</span><br><span class="line">log_errors = On</span><br></pre></td></tr></table></figure>
<ul>
<li>推荐使用 <a href="https://github.com/filp/whoops" target="_blank" rel="noopener"><code>Whoops</code></a> 组件在开发环境中处理 PHP 错误和异常。</li>
<li>推荐使用 <a href="https://github.com/Seldaek/monolog" target="_blank" rel="noopener"><code>Monolog</code></a> 组件在生产环境中记录 PHP 错误和异常。</li>
</ul>
<h1 id="主机"><a href="#主机" class="headerlink" title="主机"></a>主机</h1><ul>
<li>存储 PHP 应用的四种方式：<ul>
<li>共享服务器（Shared hosting）</li>
<li>虚拟私有服务器（VPS）</li>
<li>专用服务器</li>
<li>平台即服务（PasS）</li>
</ul>
</li>
<li>共享主机账户会与很多其他顾客的账户在同一个物理设备中。PHP 应用能使用多少设备在内存取决于这台设备中有多少账户。共享主机适合少预算，或简单需求。</li>
<li>虚拟私有服务器（VPS）提供了足够的系统资源，需要我们根据 PHP 应用的需求，自己动手配置和保护操作系统。</li>
<li>PasS 只需账号登陆，使用提供商的控制面板，单击按钮即可完成操作。有些 PasS 提供商会提供命令行工具或 Http Api，让我们部署和管理存储的 PHP 应用。适合小型 PHP 应用省心省事。</li>
</ul>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="PHP-FPM"><a href="#PHP-FPM" class="headerlink" title="PHP-FPM"></a>PHP-FPM</h2><ul>
<li>PHP-FPM 全局配置 <code>php-fpm.conf</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">emergency_restart_threshold = 10</span><br><span class="line">//在指定的一段时间内，如果失效的 PHP-FPM 子进程数超过这个值，PHP-FPM 主进程就优雅重启。</span><br><span class="line"></span><br><span class="line">emergency_restart_interval = 1m</span><br><span class="line">//设定 emergency_restart_threshold 设置采用的时间跨度。</span><br></pre></td></tr></table></figure>
<ul>
<li>PHP-FPM 进程池配置 <code>fpm/pool.d/*.conf</code> 或 <code>php-fpm.d/*.conf</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">user = deploy</span><br><span class="line">//运行 PHP 应用的非根用户的用户名</span><br><span class="line"></span><br><span class="line">group = deploy</span><br><span class="line">//运行 PHP 应用的非根用户所属的用户组名</span><br><span class="line"></span><br><span class="line">listen = 127.0.0.1:9000</span><br><span class="line">//PHP-FPM 进程池监听的 IP 地址和端口号</span><br><span class="line"></span><br><span class="line">listen.allowed_clients = 127.0.0.1</span><br><span class="line">//可以向该 PHP-FPM 进程池发送请求的 IP 地址（一个或多个）。</span><br><span class="line"></span><br><span class="line">pm.max_children = 51</span><br><span class="line">//设定任何时间点 PHP-FPM 进程池中最多能有多少个进程。可以设置的值设为总内存 / 每个进程使用的内存大小</span><br><span class="line"></span><br><span class="line">pm.start_servers = 3</span><br><span class="line">//PHP-FPM 启动时 PHP-FPM 进程池中立即可用的进程数。建议设为 2 或 3。</span><br><span class="line"></span><br><span class="line">pm.min_spare_servers = 2</span><br><span class="line">//PHP 应用空闲时 PHP-FPM 进程池中可以存在的进程数量最小值。一般与 pm.start_servers 设置值一样</span><br><span class="line"></span><br><span class="line">pm.max spare servers = 4</span><br><span class="line">//PHP 应用空闲时 PHP-FPM 进程池中可以存在的进程数量最大值。一般比 pm.start_servers 设置的值大一点</span><br><span class="line"></span><br><span class="line">pm.max requests = 1000</span><br><span class="line">//回收进程之前，PHP-FPM 进程池中各个进程最多能处理的 HTP 请求数量。</span><br><span class="line"></span><br><span class="line">slowlog = /path/to/slowlog log</span><br><span class="line">//设置慢日志（处理时间超过 n 秒的 HTTP 请求信息）的绝对路径。注意 PHP-FPM 进程池所属的用户和用户组必须有这个文件的写权限。</span><br><span class="line"></span><br><span class="line">request_slowlog_timeout = 5s</span><br><span class="line">//慢日志记录的 HTTP 请求的时间下限，超过此值即记录慢日志</span><br></pre></td></tr></table></figure>
<h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    # Nginx 监听端口</span><br><span class="line">    listen 80;</span><br><span class="line">    # 虚拟主机的域名</span><br><span class="line">    server_name example.com;</span><br><span class="line">    # HTTP 请求 URI 没指定文件时访问的默认文件</span><br><span class="line">    index index.php;</span><br><span class="line">    # Nginx 接受 HTTP 请求主体长度的最大值</span><br><span class="line">    client_max_body_size 50M;</span><br><span class="line">    # 错误日志文件路径</span><br><span class="line">    error_log /home/deploy/apps/logs/example.error.log;</span><br><span class="line">    # 访问日志文件路径</span><br><span class="line">    access_log /home/deploy/apps/logs/example_access.log;</span><br><span class="line">    # 文档根目录路径</span><br><span class="line">    root /home/deploy/apps/example.com/current/public;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        tryz_files $uri $uri/ /index.php$is_args$args;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ \.php &#123;</span><br><span class="line">        try_files $uri =404;</span><br><span class="line">        fastcgi_split_path_info ^(.+\.php)(/.+)$;</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">        fastcgi_param SCRIPT_NAME $fastcgi_script_name;</span><br><span class="line">        fastcgi_index index.php;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>指定匹配指定 URL 模式的 HTTP 请求。location / {} 块使用 try_files 指令依次进行如下操作：<ol>
<li>査找匹配所请求 URI 的文件</li>
<li>查找匹配所请求 URI 的目录</li>
<li>把 HTTP 请求的 URI 重写为 /index.php，把査询字符附加到 URI 的末尾。</li>
</ol>
</li>
<li>重写的 URL 和所有以 .php 结尾的 URI 都由 location ~ .php {} 块管理，上例中该块规定把 HTTP 请求转发给 PHP-FPM 进程池处理。</li>
</ul>
<h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><ul>
<li><code>php.ini</code> 配置中，建议修改 <code>upload_max_filesize = 10MB</code> 设置允许上传文件的大小</li>
<li><code>php.ini</code> 配置中，建议修改 <code>max_execution_time = 5</code> 设置单个 PHP 进程在终止之前最长可以运行多少时间。</li>
<li>应该在较少的块中发送更多的数据，而不是在较多的块中发送较少的数据，这样能减少 HTTP 请求总数。为此需要在 <code>php.ini</code> 配置中启用 PHP 输出缓存功能：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">output_buffering = 4096 // 输出缓存区大小</span><br><span class="line">implicit_flush = false</span><br></pre></td></tr></table></figure>
<h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>使用 <a href="https://github.com/capistrano/capistrano" target="_blank" rel="noopener">Capistrano</a> 来进行项目部署，可以方便地进行迭代和回滚操作。Capistrano 会在远程服务器中保存之前部署的应用，而且每次部署的版本放在各自的目录中。Capistrano 会维护五个或更多之前部署的应用，以防需要回滚到早前版本。Capistrano 还会创建一个 <code>current/</code> 目录,通过符号链接指向当前部署的应用所在的目录。具体步骤如下：</p>
<ol>
<li>在本地安装 ruby 和 gem   </li>
<li>在本地安装 Capistrano：<code>$ gem install capistrano</code>   </li>
<li><p>在项目根目录进行初始化：<code>$ cap install</code>，产生的初始化文件结构如下：   </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">├── Capfile                 //配置文件</span><br><span class="line">├── config                  //分环境配置文件</span><br><span class="line">│   ├── deploy              //环境配置目录</span><br><span class="line">│   │   ├── production.rb   //生产环境设置</span><br><span class="line">│   │   └── staging.rb      //过渡环境设置</span><br><span class="line">│   └── deploy.rb           //所有环境的通用设置</span><br><span class="line">└── lib</span><br><span class="line">    └── capistrano</span><br><span class="line">            └── tasks</span><br></pre></td></tr></table></figure>
</li>
<li><p>在远程服务器安装 Git：<code>$ yum install git</code></p>
</li>
<li>部署时在本地执行部署命令：<code>$ cap production deploy</code></li>
<li>回滚时在本地执行部署命令：<code>$ cap production deploy:rollback</code></li>
</ol>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>不同的测试方式之间不是互斥：   </p>
<ul>
<li>单元测试：单独证实应用中的各个类、方法和函数能正常运行。PHP 通常使用 PHPUnit 单元测试框架进行单元测试。<a href="https://phpunit.de/" target="_blank" rel="noopener">PHPUnit</a> 遵守 xUnit 测试架构。</li>
<li>测试驱动开发（Test-Driven Development, TDD）：在编写应用代码之前先写测试。故意让测试失败以描述应用应该具有怎样的表现。开发好应用的功能后，最终测试会成功通过。</li>
<li>行为驱动开发（Behavior-Driven Development, BDD）：编写故事，描述应用的表现。按导向不同氛围两类，二者一般可以共存互补，使项目获得更全面的测试。<ul>
<li>SpecBDD 是一种单元测试，使用人类能读懂的流畅语言描述应用的实现方式。例如，可能会把某个 PHPUnit 测试命名为 <code>testrendertemplate()</code>，把等价的 SpecBDD 测试命名为 <code>itrendersthetemplate()</code>，和 Xunit 工具相比更易于阅读和理解。通常使用的 SpecBDD 测试工具是 <a href="http://www.phpspec.net/" target="_blank" rel="noopener">PHPSPEC</a></li>
<li>StoryBDD 也使用人类能读懂的故事，不过 StoryBDD 关注更多的是整体行为，而不是低层实现。StoryBDD 测试关注项目整体的运行结果，而 SpecBDD 测试关注开发过程中的每个细节，如类、方法的正确性。通常使用的 StoryBDD 测试工具是 [Behat](<a href="http://behat.org/）" target="_blank" rel="noopener">http://behat.org/）</a></li>
</ul>
</li>
</ul>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><ul>
<li>开发环境使用 <a href="http://xdebiug.org" target="_blank" rel="noopener">XDebug</a>：使用时会消耗大量系统资源，借助 <a href="http://kcachegrind.sourceforge.net/" target="_blank" rel="noopener">KCacheGrind</a> 和 <a href="https://sourceforge.net/projects/wincachegrind/" target="_blank" rel="noopener">WinCacheGrind</a> 查看分析报告。</li>
<li>生产环境使用 <a href="http://xhprof.io" target="_blank" rel="noopener">XHProf</a>：使用时会消耗的系统资源少，借助 XHGUI 查看分析报告。</li>
</ul>
<h1 id="HHVM-和-Hack"><a href="#HHVM-和-Hack" class="headerlink" title="HHVM 和 Hack"></a>HHVM 和 Hack</h1><ul>
<li>PHP 是传统意义上的解释型语言，而不是编译型语言。因此，在命令行或 Web 服务器调用解释器解释 PHP 代码之前，PHP 代码就是 PHP 代码。PHP 解释器会解释 PHP 脚本，把代码转换成一系列 <a href="http://php.net/manual/internals2.opcodes.php" target="_blank" rel="noopener">Zend 操作码</a>（机器码指令），再把这些操作码交给 Zend Engine 执行。但解释型语言执行的速度比編译型语言慢很多，因为每次执行解释型语言编写的代码时都要将其转换成机器码，消耗额外的系统资源。</li>
<li>2010 年 Facebook 开发一个 HPHPc 的编译器，把 PHP 代码编译为 C++ 代码，再把 C++ 代码编译成可执行文件。但 HPHPc 对性能的提升已经到顶。于是 Facebook 开发了下一代 HPHPc，即 HHVM。HHVM 先把 PHP 代码转换成一种字节码中间格式，而且会缓存转换得到的字节码，然后使用 JIT 编译器转换并优化缓存的字节码，将其变成 x86_64 机器码。之后 HPHPc 被废弃。</li>
<li><a href="http://hacklang.org" target="_blank" rel="noopener">Hack</a> 是一门服务器端语言，类似 PHP，且可以和 PHP 无缝集成。Hack 的开发者其实把 Hack 当做 PHP 的一种方言。从 PHP 转到 Hack 只需将 PHP 标签 <code>&lt;?php</code> 改为 <code>&lt;?hh</code> 即可。</li>
<li>Hack 既支持静态类型，也支持动态类型，且基本上能向后兼容普通的 PHP，所以其支持所有 PHP 动态类型特性。HHVM 读取 Hack 代码后会优化和缓存中间字节码，只在需要时才把 Hack 文件转换成 x86_64 机器码。Hack 充分利用了两种类型系统的特性，我们通过 Hack 的类型检査程序得到了静态类型的准确性和安全性，又通过 HVM 的 JIT 编译器得到了动态类型的灵活性和快速迭代。</li>
<li>Hack 自带一个单独的类型检査服务器，这个服务器在后台运行，会实时对代码做类型检査。</li>
<li><p>Hack 代码有三种編写模式：</p>
<ul>
<li>严格模式：<code>&lt;?hh // strict</code> 要求所有变量、函数、方法等代码都有合适的类型注解。且代码中不能有 Hack 之外的代码。</li>
<li>局部模式：<code>&lt;?hh // partial</code> 允许在 Hack 代码中使用还没转换成 Hack 的 PHP 代码。不要求注解函数或方法的所有参数，如果只注解部分参数，Hack 的类型检査程序也不会报错。</li>
<li>声明模式：<code>&lt;?php // decl</code> 允许严格模式的 Hack 代码调用未指定类型的代码。</li>
</ul>
</li>
<li><p>Hack 提供了 PHP 没有的新数据结构和接口数据结构：</p>
<ul>
<li><a href="https://docs.hhvm.com/hack/built-in-types/arrays" target="_blank" rel="noopener">集合</a>（矢量，映射， 集和值对。）</li>
<li><a href="https://docs.hhvm.com/hack/generics/introduction" target="_blank" rel="noopener">泛型</a></li>
<li><a href="https://docs.hhvm.com/hack/built-in-types/enumerated-types" target="_blank" rel="noopener">枚举</a></li>
<li><a href="https://docs.hhvm.com/hack/built-in-types/shapes" target="_blank" rel="noopener">形状</a></li>
<li><a href="https://docs.hhvm.com/hack/built-in-types/tuples" target="_blank" rel="noopener">元组</a></li>
</ul>
</li>
</ul>

    </div>

    
    
    <script src="/js/src/baffle.min.js"></script>
<script>
  let b = baffle(document.querySelectorAll('.post-title'));
  b.set({
    speed: 100,
    characters: '/>░░▒▒▓▓██锟斤拷烫'
  });
  b.reveal(3500, 1000);
</script>

        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Acuario</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://acuario.xyz/modern-php-summary/" title="《Modern PHP》学习笔记">https://acuario.xyz/modern-php-summary/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/学习笔记/" rel="tag"># 学习笔记</a>
            
              <a href="/tags/PHP/" rel="tag"># PHP</a>
            
              <a href="/tags/Modern-PHP/" rel="tag"># Modern PHP</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/mastering-regex-summary-6/" rel="next" title="《精通正则表达式》学习笔记（六）">
                  <i class="fa fa-chevron-left"></i> 《精通正则表达式》学习笔记（六）
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/podcast-note-4/" rel="prev" title="播客札记（四）：消费主义&审美">
                  播客札记（四）：消费主义&审美 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    
  <div class="comments" id="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#命名空间（namespace）"><span class="nav-number">1.</span> <span class="nav-text">命名空间（namespace）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基本概念"><span class="nav-number">1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#导入和别名"><span class="nav-number">1.2.</span> <span class="nav-text">导入和别名</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#接口（interface）"><span class="nav-number">2.</span> <span class="nav-text">接口（interface）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#性状（trait）"><span class="nav-number">3.</span> <span class="nav-text">性状（trait）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#生成器（generator）"><span class="nav-number">4.</span> <span class="nav-text">生成器（generator）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#闭包（closure）"><span class="nav-number">5.</span> <span class="nav-text">闭包（closure）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Zend-OPcache"><span class="nav-number">6.</span> <span class="nav-text">Zend OPcache</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#内置的-HTTP-服务器"><span class="nav-number">7.</span> <span class="nav-text">内置的 HTTP 服务器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#标准"><span class="nav-number">8.</span> <span class="nav-text">标准</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PSR-1：基本的代码风格"><span class="nav-number">8.1.</span> <span class="nav-text">PSR-1：基本的代码风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PSR-2：严格的代码风格"><span class="nav-number">8.2.</span> <span class="nav-text">PSR-2：严格的代码风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PSR-3：日志记录器接口"><span class="nav-number">8.3.</span> <span class="nav-text">PSR-3：日志记录器接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PSR-4：自动加载器"><span class="nav-number">8.4.</span> <span class="nav-text">PSR-4：自动加载器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#组件"><span class="nav-number">9.</span> <span class="nav-text">组件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#良好实践"><span class="nav-number">10.</span> <span class="nav-text">良好实践</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#过滤、验证和转义"><span class="nav-number">10.1.</span> <span class="nav-text">过滤、验证和转义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#密码"><span class="nav-number">10.2.</span> <span class="nav-text">密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期、时间和时区"><span class="nav-number">10.3.</span> <span class="nav-text">日期、时间和时区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库"><span class="nav-number">10.4.</span> <span class="nav-text">数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#错误和异常"><span class="nav-number">10.5.</span> <span class="nav-text">错误和异常</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#主机"><span class="nav-number">11.</span> <span class="nav-text">主机</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置"><span class="nav-number">12.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP-FPM"><span class="nav-number">12.1.</span> <span class="nav-text">PHP-FPM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginx"><span class="nav-number">12.2.</span> <span class="nav-text">Nginx</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#优化"><span class="nav-number">13.</span> <span class="nav-text">优化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#部署"><span class="nav-number">14.</span> <span class="nav-text">部署</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试"><span class="nav-number">15.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#分析"><span class="nav-number">16.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HHVM-和-Hack"><span class="nav-number">17.</span> <span class="nav-text">HHVM 和 Hack</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="Acuario">
  <p class="site-author-name" itemprop="name">Acuario</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">58</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">98</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/yhyy135" title="GitHub &rarr; https://github.com/yhyy135" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://twitter.com/yhyy135" title="Twitter &rarr; https://twitter.com/yhyy135" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
    
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://droid4.us/" title="https://droid4.us/" rel="noopener" target="_blank">Droid4us</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://songf.me/" title="https://songf.me/" rel="noopener" target="_blank">bennxs</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://meteoritey.github.io/" title="https://meteoritey.github.io/" rel="noopener" target="_blank">Pithoi</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://acehjm.github.io/" title="https://acehjm.github.io/" rel="noopener" target="_blank">junaiu Ma</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://blog.yeyanjie.com/" title="https://blog.yeyanjie.com/" rel="noopener" target="_blank">Jarvis Ye</a>
        </li>
      
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Acuario</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.0</div><script src="https://cdn.jsdelivr.net/npm/meting/dist/Meting.min.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://acuraioo.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  function disqus_config() {
    this.page.url = "https://acuario.xyz/modern-php-summary/";
    this.page.identifier = "modern-php-summary/";
    this.page.title = '《Modern PHP》学习笔记';};
  function loadComments() {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://acuraioo.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  }
    window.addEventListener('load', loadComments, false);
  
</script>

</body>
</html>
